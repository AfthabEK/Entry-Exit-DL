{% extends 'base.html'%}
{% load static %}
{% block title %}
  Home
{% endblock %}

{% block content %}
    <br>
    <br>
    <br>
    <br>
    <h1 class="text-center " style="font-size: 50px;">Central Library Entry-Exit System</h1>
    <!-- make the message green when it is an entry and red when it is exit-->

    <h1 class="text-center text-black-100">Place your ID card on the reader</h1>
    <h3 class="text-center" id="message"></h3>
        
    <div class="text-center mt-4 mb-5">
        <input type="text" id="student_id" name="student_id"> <!-- Added id attribute -->
        <input type="submit" id="Submit" value="Submit" onclick="submit();" class="text-center btn btn-dark" autofocus>
    </div>
      <h2 class="text-center">Number of Students Inside: {{count}}</h2>    
      <h2 class="text-center">Total Visits Today: {{total_visits_today}}</h2>

    <br>
    <br>
    <br>

    <table class="neon-table">
      <thead>
          <tr>
              <th>Morning 00:00 - 08:00</th>
              <th>General 08:00 - 16:30</th> 
              <th>Night 16:30 - 00:00</th>
          </tr>
      </thead>
      <tbody>
          <tr>
              <td>
                  <p>{{ morning_count }}</p>
              </td>
              <td>
                  <p>{{ general_count }}</p>
              </td>
              <td>
                  <p>{{ night_count }}</p>
              </td>
          </tr>
      </tbody>
  </table>
    <br>

<<<<<<< HEAD
    <script src="{% static 'script.js' %}"></script>
    <script src="{% static 'toggle.js' %}"></script>
=======
    <script>
        // Focus on the input field when the page loads
        window.addEventListener('load', function() {
            document.getElementById('student_id').focus();
        });

        var msg = document.getElementById("message");

	var ws_url = "ws://" + window.location.hostname + ":8765";
	console.log(ws_url);
	var socket = new WebSocket(ws_url);
	var input = document.getElementsByTagName('input')[0];
	input.addEventListener("keydown", function(e){
		if(e.code=="Enter")
			submit();
	});
	function shorten_message(){
		let content = msg.innerHTML;
		msg.innerHTML = content.substr(content.indexOf('<br>')+4);
	}
	function response(event) {
		let message = event.data;
		msg.innerHTML = msg.innerHTML + message + '<br>';
		console.log(msg.innerHTML);
		console.log(message);
		setTimeout(shorten_message, 5000);
	};

	socket.onmessage = response;
	function submit(){
		socket.send(input.value);
	}
    </script>
>>>>>>> b6efa12 (added new feature: login without hitting Enter)
    
{% endblock %}
